{% extends "base.html" %}

{% block title %}{{ team.name }} - FIFA World Cup 2026{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="flex justify-between items-center mb-6">
        <div>
            <a href="/teams" class="text-fifa-blue hover:underline text-sm">&larr; Back to Teams</a>
            <h1 class="text-3xl font-bold">{{ team.name }}</h1>
        </div>
        <div class="text-right">
            <div class="text-3xl font-bold text-fifa-blue">{{ total_score }}</div>
            <div class="text-sm text-gray-500">total points</div>
        </div>
    </div>

    <div class="card">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold">Members ({{ members|length }})</h2>
            {% if is_admin %}
                <span class="text-sm text-fifa-blue">You are the admin</span>
            {% endif %}
        </div>

        {% if members|length < 2 %}
            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-4">
                <p class="text-sm text-yellow-700">
                    This team needs at least 2 members to compete. Invite friends to join!
                </p>
            </div>
        {% endif %}

        <div class="space-y-2">
            {% for member in members %}
                <div class="flex justify-between items-center p-3 bg-gray-50 rounded {{ 'bg-blue-50' if current_user and member.id == current_user.id }}">
                    <div class="flex items-center gap-3">
                        <span class="font-medium">{{ member.display_name }}</span>
                        {% if member.id == team.admin_user_id %}
                            <span class="text-xs bg-fifa-blue text-white px-2 py-1 rounded">Admin</span>
                        {% endif %}
                    </div>
                    <div class="flex items-center gap-4">
                        <span class="font-bold">{{ member.points }} pts</span>
                        {% if is_admin and member.id != current_user.id %}
                            <form method="POST" action="/teams/{{ team.id }}/remove/{{ member.id }}" onsubmit="return confirm('Remove {{ member.display_name }} from team?')">
                                <button type="submit" class="text-red-600 text-sm hover:underline">Remove</button>
                            </form>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    {% if current_user %}
        <div class="mt-6 flex justify-between">
            {% if is_member and not is_admin %}
                <form method="POST" action="/teams/{{ team.id }}/leave" onsubmit="return confirm('Leave this team?')">
                    <button type="submit" class="btn-secondary">Leave Team</button>
                </form>
            {% elif not is_member %}
                <form method="POST" action="/teams/{{ team.id }}/join">
                    <button type="submit" class="btn-primary">Join Team</button>
                </form>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}
